---
title: "Second Moments and Nearest Neighbour Distribution"
author: "Natalie Young"
date: "2023-07-27"
categories: [news, analysis]
bibliography: ../../references.bib
link-citations: TRUE
draft: false
image: edgecorr.PNG
---
Thumbnail taken from Chapter 4 of the Diggle book: [@DiggleBook]

This week we will explore some theoretical summary descriptions of
spatial point processes. First, we need to define some notations.

$E(X) =$ expectation of a random variable $X$

$N(A) =$ number of events in the planar region $A$

$N_j(A) =$ number of type $j$ events in $A$ for a multivariate process

$|A| =$ area of $A$

$dx =$ an infinitesimal region that contains the point $x$

$\|x-y\| =$ the Euclidean distance between the points $x$ and $y$

# Second order properties
First-order properties are described by an intensity function,
$$
\lambda (x) = \lim_{|dx|\rightarrow 0} \{\frac{E[N(dx)]}{|dx|}\}
$$
For a *stationary* process, i.e. a process with all properties invariant under translation,
$\lambda(x)$ is a constant, representing the mean number of events per unit area.

The second-order intensity function is defined as,
$$
\lambda_2(x, y) = \lim_{|dx|, |dy|\rightarrow 0}\{\frac{E[N(dx)N(dy)]}{|dx||dy|}\}
$$
We also note that the *conditional intensity* is $\lambda_c(x|y)=\lambda_2(x, y)/\lambda(y)$,
the intensity at point $x$ given there is an event at point $y$. If the process is stationary,
$\lambda_2(x, y) \equiv \lambda_2(x-y)$. If the process is additionally isotropic, i.e.
all process properties are invariant under rotation, we can reduce $\lambda_2(x-y)$ to
$\lambda_2(t)$, with $t=\|x-y\|$.

The *pair correlation function* is defined as $\rho(t)=\lambda_2(t)/\lambda^2$. For
*intensity-reweighted (second-order) stationary processes*,
$$
\frac{\lambda_2(x,y)}{\lambda(x)\lambda(y)} = \rho(t)
$$
only depends on $t=\|x-y\|$.

# The K function
The K function also characterises second-order properties of a stationary, isotropic process.
It is defined as the following:
$$
K(t) = \frac{E[N_0(t)]}{\lambda}
$$
where $N_0(t)$ is the number of other events taking place within distance $t$ of
an arbitrary event. In order to link $K(t)$ and $\lambda_2(t)$, we will assume that
multiple events cannot occur at the same point. $E[N(dx)] \sim P\{N(dx) = N(dy)=1\}$,
due to ratio of both quantities tending to 1 as $|dx| \rightarrow 0$. Under these
conditions, $E[N_0(t)]$ can be computed by integrating the conditional intensity
over the disc centering at the origin and radius $t$:
$$
\begin{align}
  \lambda K(t) &= \int_0^{2\pi} \int_0^t \lambda_c(x|o)xdxd\theta \\
  &= \frac{2\pi}{\lambda} \int_0^t \lambda_2(x)xdx
\end{align}
$$

Rather than taking the exact locations of each event, sometimes we prefer to take
counts in quadrats. The quadrat count distribution,
$$
p_n(A) = P\{N(A)=n\}
$$
provides a summary description of the process. Since $A$ is arbitrary, we can summarise
the distribution by the first few moments and express them as functions of $A$.
In particular, $E[N(A)]=\int_A \lambda(x)dx$ reduces to $\lambda |A|$ for a stationary
process.

By orderliness,
$$
\begin{align}
E[N(A)^2] &= E[\{\int_ANdx\}]^2 \\
&= E[\int_ANdx + \int_A \int_A NdxNdy] \\
&= \lambda|A| + \int_A \int_A\lambda_2(x-y)dxdy
\end{align}
$$
And we have:
$$
Var\{N(A)\} = \int_A \int_A \lambda_2(x-y)dxdy + \lambda|A|(1-\lambda|A|)
$$
# Multivariate processes
As defined before, $N_j(A)$ is the number of type $j$ events in the planar region $A$.
If we assume  stationarity, isotropy and orderliness, the first order intensities are constants:
$$
\lambda_j = E[N_j(A)]/|A|
$$
The second order intensities are:
$$
\lambda_{ij}(t) = \lim_{|dx| \rightarrow 0\\ |dy| \rightarrow 0}
\{\frac{E[N_i(dx)N_j(dy)]}{|dx||dy|}\}
$$
And the K-function would be defined as follows:
$$
K_{ij}(t) = \frac{E[N_{0ij}(t)]}{\lambda_j}
$$
Note that $\lambda_{ij}(t) = \lambda_{ji}(t)$ and $K_{ij}(t) = K_{ji}(t)$.

# Independence and random labelling
We might be interested in testing whether 2 different types of events have spatial
association in a bivariate process. 2 of the possible hypotheses we could consider are:

(i) Independence - the 2 types of events are generated by 2 independent univariate processes

(ii) Random labelling - the 2 types of events can be obtained by labelling the events
from a univariate process with independent Bernoulli trials.

For 2 independent processes of 2 event types, $K_{12}(t)=\pi t^2$. This follows from
the fact that the expected number of type 2 events in a disc of radius $t$
centred around an arbitrary type 1 event, $E[N_{012}(t)]=\lambda_2 \pi t^2$.

As for any randomly labelled process, $K_{11}(t)=K_{22}(t)=K_{12}(t)=K(t)$, the
K-function for the unlabelled univariate process.

Independence and random labelling are equivalent if and only if both types of events
are Poisson processes.