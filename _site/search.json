[
  {
    "objectID": "posts/Testing for CSR/index.html",
    "href": "posts/Testing for CSR/index.html",
    "title": "Testing for CSR",
    "section": "",
    "text": "Now we will investigate some CSR tests, with the help of the spatstat package in RStudio."
  },
  {
    "objectID": "posts/Testing for CSR/index.html#monte-carlo-test",
    "href": "posts/Testing for CSR/index.html#monte-carlo-test",
    "title": "Testing for CSR",
    "section": "Monte Carlo test",
    "text": "Monte Carlo test\n2 ways to construct an exact Monte Carlo test for CSR are as below:\n\nChoose \\(t_0\\) and let \\(u_i = \\hat{H}_i(t_0)\\). The rank of \\(u_1\\) is a basis for the test as under CSR, all rankings of \\(u_1\\) are equally probable.\nDefine \\(u_i\\) to be a measure of variation between \\(\\hat{H}_i(t)\\) and \\(H(t)\\), e.g. \\(u_i = \\int \\{\\hat{H}_i(t)-H(t)\\}^2 \\space dt\\), then base the test on the rank of \\(u_1\\).\n\nFor (i), we would need to choose a sensible \\(t_0\\) for the problem. While (ii) is more objective, it may not be a powerful test for inter-event distances.\nFor a region A in which \\(H(t)\\) is unknown, we can replace it by: \\[\n\\bar{H}_i(t) = \\frac{1}{s-1}\\displaystyle \\sum_{j \\ne i}\\hat{H}_j(t)\n\\] While \\(u_i\\) under CSR is no longer independent, it still fulfills the requirement that all rankings of \\(u_1\\) are equi-probable, as they are inter-changeable. We can plot \\(U(t), \\space L(t)\\) and \\(\\hat{H}_1(t)\\) against \\(\\bar{H}_1(t)\\). Since \\(\\bar{H}_1(t)\\) only depends on simulations of CSR, it is an unbiased estimate of \\(H(t)\\)."
  },
  {
    "objectID": "posts/Testing for CSR/index.html#monte-carlo-test-1",
    "href": "posts/Testing for CSR/index.html#monte-carlo-test-1",
    "title": "Testing for CSR",
    "section": "Monte Carlo test",
    "text": "Monte Carlo test\nPossible test statistics for the Monte Carlo test could be \\(\\bar{y}\\), the sample mean of the nearest distances, or \\[\nu_i = \\int \\{\\hat{G}_i(y)-\\bar{G}_i(y)\\}^2 \\space dy,\n\\] where \\[\n\\bar{G}_i(y) = \\frac{1}{s-1}  \\displaystyle\\sum_{j \\ne i} \\hat{G}_j(y)\n\\] An advantage of using \\(\\bar{y}\\) is that simulation is unnecessary. As shown by Donnelly(1978), \\(\\bar{y}\\) under CSR is Normally distributed, with mean and variance: \\[\nE(\\bar{y}) = 0.5(\\frac{n}{|A|})^{1/2} + \\frac{1}{n}(0.051+0.042n^{-1/2})P\n\\] and \\[\nVar(\\bar{y}) = 0.070n^{-2}|A|+0.037(n^{-5}|A|)^{1/2}P\n\\] where P is the perimeter of region A. Significantly small or large \\(\\bar{y}\\) suggests aggregation or regularity, respectively."
  },
  {
    "objectID": "posts/Second moments and Nearest Neighbour Distribution/index.html",
    "href": "posts/Second moments and Nearest Neighbour Distribution/index.html",
    "title": "Second Moments and Nearest Neighbour Distribution",
    "section": "",
    "text": "This week we will explore some theoretical summary descriptions of spatial point processes. First, we need to define some notations.\n\\(E(X) =\\) expectation of a random variable \\(X\\)\n\\(N(A) =\\) number of events in the planar region \\(A\\)\n\\(N_j(A) =\\) number of type \\(j\\) events in \\(A\\) for a multivariate process\n\\(|A| =\\) area of \\(A\\)\n\\(dx =\\) an infinitesimal region that contains the point \\(x\\)\n\\(\\|x-y\\| =\\) the Euclidean distance between the points \\(x\\) and \\(y\\)\n\nSecond order properties\nFirst-order properties are described by an intensity function, \\[\n\\lambda (x) = \\lim_{|dx|\\rightarrow 0} \\{\\frac{E[N(dx)]}{|dx|}\\}\n\\] For a stationary process, i.e. a process with all properties invariant under translation, \\(\\lambda(x)\\) is a constant, representing the mean number of events per unit area.\nThe second-order intensity function is defined as, \\[\n\\lambda_2(x, y) = \\lim_{|dx|, |dy|\\rightarrow 0}\\{\\frac{E[N(dx)N(dy)]}{|dx||dy|}\\}\n\\] We also note that the conditional intensity is \\(\\lambda_c(x|y)=\\lambda_2(x, y)/\\lambda(y)\\), the intensity at point \\(x\\) given there is an event at point \\(y\\). If the process is stationary, \\(\\lambda_2(x, y) \\equiv \\lambda_2(x-y)\\). If the process is additionally isotropic, i.e. all process properties are invariant under rotation, we can reduce \\(\\lambda_2(x-y)\\) to \\(\\lambda_2(t)\\), with \\(t=\\|x-y\\|\\).\nThe pair correlation function is defined as \\(\\rho(t)=\\lambda_2(t)/\\lambda^2\\). For intensity-reweighted (second-order) stationary processes, \\[\n\\frac{\\lambda_2(x,y)}{\\lambda(x)\\lambda(y)} = \\rho(t)\n\\] only depends on \\(t=\\|x-y\\|\\).\n\n\nThe K function\nThe K function also characterises second-order properties of a stationary, isotropic process. It is defined as the following: \\[\nK(t) = \\frac{E[N_0(t)]}{\\lambda}\n\\] where \\(N_0(t)\\) is the number of other events taking place within distance \\(t\\) of an arbitrary event. In order to link \\(K(t)\\) and \\(\\lambda_2(t)\\), we will assume that multiple events cannot occur at the same point. \\(E[N(dx)] \\sim P\\{N(dx) = N(dy)=1\\}\\), due to ratio of both quantities tending to 1 as \\(|dx| \\rightarrow 0\\). Under these conditions, \\(E[N_0(t)]\\) can be computed by integrating the conditional intensity over the disc centering at the origin and radius \\(t\\): \\[\n\\begin{align}\n  \\lambda K(t) &= \\int_0^{2\\pi} \\int_0^t \\lambda_c(x|o)xdxd\\theta \\\\\n  &= \\frac{2\\pi}{\\lambda} \\int_0^t \\lambda_2(x)xdx\n\\end{align}\n\\]\nRather than taking the exact locations of each event, sometimes we prefer to take counts in quadrats. The quadrat count distribution, \\[\np_n(A) = P\\{N(A)=n\\}\n\\] provides a summary description of the process. Since \\(A\\) is arbitrary, we can summarise the distribution by the first few moments and express them as functions of \\(A\\). In particular, \\(E[N(A)]=\\int_A \\lambda(x)dx\\) reduces to \\(\\lambda |A|\\) for a stationary process.\nBy orderliness, \\[\n\\begin{align}\nE[N(A)^2] &= E[\\{\\int_ANdx\\}]^2 \\\\\n&= E[\\int_ANdx + \\int_A \\int_A NdxNdy] \\\\\n&= \\lambda|A| + \\int_A \\int_A\\lambda_2(x-y)dxdy\n\\end{align}\n\\] And we have: \\[\nVar\\{N(A)\\} = \\int_A \\int_A \\lambda_2(x-y)dxdy + \\lambda|A|(1-\\lambda|A|)\n\\] # Multivariate processes As defined before, \\(N_j(A)\\) is the number of type \\(j\\) events in the planar region \\(A\\). If we assume stationarity, isotropy and orderliness, the first order intensities are constants: \\[\n\\lambda_j = E[N_j(A)]/|A|\n\\] The second order intensities are: \\[\n\\lambda_{ij}(t) = \\lim_{|dx| \\rightarrow 0\\\\ |dy| \\rightarrow 0}\n\\{\\frac{E[N_i(dx)N_j(dy)]}{|dx||dy|}\\}\n\\] And the K-function would be defined as follows: \\[\nK_{ij}(t) = \\frac{E[N_{0ij}(t)]}{\\lambda_j}\n\\] Note that \\(\\lambda_{ij}(t) = \\lambda_{ji}(t)\\) and \\(K_{ij}(t) = K_{ji}(t)\\).\n\n\nIndependence and random labelling\nWe might be interested in testing whether 2 different types of events have spatial association in a bivariate process. 2 of the possible hypotheses we could consider are:\n\nIndependence - the 2 types of events are generated by 2 independent univariate processes\nRandom labelling - the 2 types of events can be obtained by labelling the events from a univariate process with independent Bernoulli trials.\n\nFor 2 independent processes of 2 event types, \\(K_{12}(t)=\\pi t^2\\). This follows from the fact that the expected number of type 2 events in a disc of radius \\(t\\) centred around an arbitrary type 1 event, \\(E[N_{012}(t)]=\\lambda_2 \\pi t^2\\).\nAs for any randomly labelled process, \\(K_{11}(t)=K_{22}(t)=K_{12}(t)=K(t)\\), the K-function for the unlabelled univariate process.\nIndependence and random labelling are equivalent if and only if both types of events are Poisson processes.\n\n\n\n\n\nReferences\n\nDiggle, P. J. 2013. Statistical Analysis of Spatial and Spatio-Temporal Point Patterns, Third Edition. Hoboken : Taylor; Francis."
  },
  {
    "objectID": "posts/Model fitting/index.html",
    "href": "posts/Model fitting/index.html",
    "title": "Model fitting",
    "section": "",
    "text": "To wrap up, I will evaluate the suitability of using an inhomogeneous Poisson process to model the 3 species from the Barro Colorado Island dataset. To do this, the built-in function ppm from spatstat would be helpful. Then the estimated pair correlation function (PCF) from the actual data will be plotted with the upper and lower envelopes of 99 simulations based on the fitted model for comparison. The PCF is associated with the rate of change of the K-function: \\[\n\\rho(r) = \\frac{K'(r)}{2\\pi r}\n\\] And it should equal to 1 if the process is stationary (\\(K(r)=\\pi r^2\\)). Using the PCF over the K-function could remove the effect of cumulation in the K-function, allowing for clearer observation of the behaviour.\n\nAcalypha diversifolia\n\n\n\n\n\n\n\nCecropia insignis\n\n\n\n\n\n\n\nCupania seemannii\n\n\n\n\n\nIn all of the cases, the PCF of the data lies above the simulation envelopes for small distances, then drops below the envelopes for large distances. These suggest small distance aggregation. Since there are less pairs of events with larger inter-event distances, the variance for the K-function at these distances is large.\nIt is apparent that the inhomogeneous Poisson process model is not a good fit for the data, and we would have to explore other models in order to better estimate the spread of these tree species at this location.\n\n\n\n\n\nReferences\n\n(ForestGEO), Forest Global Earth Observatory. n.d. “Barro Colorado Island.” https://www.flickr.com/photos/ctfs."
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html",
    "href": "posts/Estimation of Second Order Properties/index.html",
    "title": "Estimation of Second Order Properties",
    "section": "",
    "text": "Recall the definition of the K-function: \\[\nK(t) = \\frac{E[N_0(t)]}{\\lambda}\n\\] In small samples, estimation of \\(K(t)\\) would be more straightforward than that of \\(\\lambda_2(t)\\) or \\(\\rho(t)\\). While \\(K(t)\\) and \\(\\lambda_2(t)\\) are both related to the distribution of inter-event distances, \\(K(t)\\) can be estimated without deciding how much to smooth the empirical distribution.\nSometimes we may use random thinning (i.e. retaining or discarding each event using mutually independent Bernoulli trials) to reduce our sample size, and \\(K(t)\\) is invariant under this process. This is due to the ratio of \\(E[N_0(t)]\\) and \\(\\lambda\\) being unchanged.\nAn obvious estimator for \\(\\lambda\\) is \\(\\hat{\\lambda} = n/|A|\\), the number of observed events divided by the area. As for \\(E[N_0(t)]\\), the expected number of further events within distance \\(t\\) of an arbitrary event, we can use the following estimator: \\[\n\\tilde{E}(t) = \\frac{1}{n} \\displaystyle \\sum_{i=1}^n \\sum_{j \\ne i} I(r_{ij} \\leq t)\n\\] where \\(I\\) is the indicator function and \\(r_{ij} = ||x_i - x_j||\\). However, this estimator is negatively biased due to edge-effects, where events outside of the observed region may interact with those within the region. In this case, some events that lie within distance \\(t\\) may be unobserved as they lie outside the region."
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html#japanese-black-pines",
    "href": "posts/Estimation of Second Order Properties/index.html#japanese-black-pines",
    "title": "Estimation of Second Order Properties",
    "section": "Japanese black pines",
    "text": "Japanese black pines\n\n\n\n\n\nWe see that \\(\\hat{K}(t)\\) lies close to \\(K(t)\\), and remains inside the envelopes. CSR is evident, which agrees with our previous tests of CSR."
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html#redwood",
    "href": "posts/Estimation of Second Order Properties/index.html#redwood",
    "title": "Estimation of Second Order Properties",
    "section": "Redwood",
    "text": "Redwood\n\n\n\n\n\nWith the majority proportion of \\(\\hat{K}(t)\\) lying above 2 standard errors of \\(K(t)\\), it is clear that the data is aggregated, since there are more further events expected around an arbitrary event compared to a homogeneous Poisson process."
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html#cells",
    "href": "posts/Estimation of Second Order Properties/index.html#cells",
    "title": "Estimation of Second Order Properties",
    "section": "Cells",
    "text": "Cells\n\n\n\n\n\nFor distances under 0.15, the expected number of further events around an arbitrary event is less than under CSR. This is a typical behaviour of regular patterns, and this agrees with our previous tests of CSR."
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html#beilschmiedia-pendula-lauraceae",
    "href": "posts/Estimation of Second Order Properties/index.html#beilschmiedia-pendula-lauraceae",
    "title": "Estimation of Second Order Properties",
    "section": "Beilschmiedia pendula (Lauraceae)",
    "text": "Beilschmiedia pendula (Lauraceae)\nSince the built-in function is not suitable for handling patterns with over 3000 data points, I am only performing the test on the top left corner of the region, which is a \\(100 \\times 100\\) square containing 136 points:\n\n\n\n\n\n\n\n\n\n\nThe clear excess of expected further events provides strong evidence against CSR. We have established from previous CSR tests that the pattern of all 3604 trees are aggregated just like the redwood saplings, and this subset behaves the same."
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html#acalypha-diversifolia-cecropia-insignis",
    "href": "posts/Estimation of Second Order Properties/index.html#acalypha-diversifolia-cecropia-insignis",
    "title": "Estimation of Second Order Properties",
    "section": "Acalypha diversifolia & Cecropia insignis",
    "text": "Acalypha diversifolia & Cecropia insignis"
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html#cecropia-insignis-cupania-seemannii",
    "href": "posts/Estimation of Second Order Properties/index.html#cecropia-insignis-cupania-seemannii",
    "title": "Estimation of Second Order Properties",
    "section": "Cecropia insignis & Cupania seemannii",
    "text": "Cecropia insignis & Cupania seemannii"
  },
  {
    "objectID": "posts/Estimation of Second Order Properties/index.html#cupania-seemannii-acalypha-diversifolia",
    "href": "posts/Estimation of Second Order Properties/index.html#cupania-seemannii-acalypha-diversifolia",
    "title": "Estimation of Second Order Properties",
    "section": "Cupania seemannii & Acalypha diversifolia",
    "text": "Cupania seemannii & Acalypha diversifolia\n\n\n\n\n\nThe first 2 pairs of species exhibit strong aggregation, while the third pair exhibits regularity."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I am Natalie Young, an undergraduate Mathematics student at Imperial College London. I will be updating this blog weekly to record my research on spatial point process and its applications in Ecology, guided by Statistical Analysis of Spatial and Spatio-temporal Point Patterns by P. J. Diggle. (Diggle 2013)\nPoint process models are a stochastic model to describe the locations of localised events in space, time or both. In particular, we will apply it to the distribution of different tree species over a 50ha tropical rainforest site on Barro Colorado Island, Panama. (H. Condit R. and Foster 2005; R. Condit 1998; Hubbell and Lao 1999)The ecological data for this site is publicly available, courtesy of the Smithsonian Tropical Research Institute.\n\n\n\nReferences\n\nCondit, Hubbell, R., and R. B. Foster. 2005. “Barro Colorado Forest Census Plot Data.” http://ctfs.si.edu/webatlas/datasets/bci.\n\n\nCondit, R. 1998. Tropical Forest Census Plots. Springer-Verlag, Berlin; R.G. Landes Company, Georgetown, Texas.\n\n\nDiggle, P. J. 2013. Statistical Analysis of Spatial and Spatio-Temporal Point Patterns, Third Edition. Hoboken : Taylor; Francis.\n\n\nHubbell, R. B. Foster, S. P., and S. Loo de Lao. 1999. “Light Gap Disturbances, Recruitment Limitation, and Tree Diversity in a Neotropical Forest.” Science 283: 554–57. https://doi.org/10.1126/science.283.5401.554."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "UROP - Spatial Point Patterns",
    "section": "",
    "text": "Model fitting\n\n\n\n\n\n\n\ncode\n\n\nanalysis\n\n\n\n\nModel fitting of BCI data. Thumbnail credit: [@BCIphoto]\n\n\n\n\n\n\nSep 10, 2023\n\n\nNatalie Young\n\n\n\n\n\n\n  \n\n\n\n\nVarious Models for Point Patterns\n\n\n\n\n\n\n\nnews\n\n\nanalysis\n\n\n\n\nVarious point pattern models. Thumbnail credit: [@contdist]\n\n\n\n\n\n\nSep 4, 2023\n\n\nNatalie Young\n\n\n\n\n\n\n  \n\n\n\n\nEstimation of Second Order Properties\n\n\n\n\n\n\n\ncode\n\n\nanalysis\n\n\n\n\nEstimating the K-function. Thumbnail credit: [@BCIphoto]\n\n\n\n\n\n\nAug 23, 2023\n\n\nNatalie Young\n\n\n\n\n\n\n  \n\n\n\n\nSimulations for CSR Tests\n\n\n\n\n\n\n\ncode\n\n\nanalysis\n\n\n\n\nCollection of simulations of CSR testings. Thumbnail: [@SPP]\n\n\n\n\n\n\nJul 28, 2023\n\n\nNatalie Young\n\n\n\n\n\n\n  \n\n\n\n\nSecond Moments and Nearest Neighbour Distribution\n\n\n\n\n\n\n\nnews\n\n\nanalysis\n\n\n\n\nExploring second order properties. Thumbnail taken from Chapter 4 of the Diggle book: [@DiggleBook]\n\n\n\n\n\n\nJul 27, 2023\n\n\nNatalie Young\n\n\n\n\n\n\n  \n\n\n\n\nTesting for CSR\n\n\n\n\n\n\n\nnews\n\n\nanalysis\n\n\n\n\n\n\n\n\n\n\n\nJul 22, 2023\n\n\nNatalie Young\n\n\n\n\n\n\n  \n\n\n\n\nIntroduction\n\n\n\n\n\n\n\nnews\n\n\n\n\nIntroducing our topic. Thumbnail image credit: [@Trees]\n\n\n\n\n\n\nJul 13, 2023\n\n\nNatalie Young\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/Introduction/index.html",
    "href": "posts/Introduction/index.html",
    "title": "Introduction",
    "section": "",
    "text": "Welcome! This week I have reviewed some introductory materials to the topic of Spatial Point Patterns. Here is a summary of them.\nA spatial point pattern refers to data which is irregularly distributed over a spatial region, such as the location of trees in an area. We denote these points as events. The positions of these events are assumed to follow an underlying process, which we aim to determine. For plant ecology, it is common to collect data by dividing the area into a regular grid of quadrats and take the count of each quadrat. An alternative method is to record the distances between a point and the neighbouring events. Both of these methods are considered sparse sampling methods."
  },
  {
    "objectID": "posts/Introduction/index.html#complete-spatial-randomness-csr",
    "href": "posts/Introduction/index.html#complete-spatial-randomness-csr",
    "title": "Introduction",
    "section": "Complete Spatial Randomness (CSR)",
    "text": "Complete Spatial Randomness (CSR)\nComplete spatial randomness (CSR), also known as the homogeneous Poisson point process, implies that:\n\nFor a planar region \\(A\\), with area \\(|A|\\), the number of events is Poisson distributed with mean \\(\\lambda |A|\\). \\(\\lambda\\), the intensity, is the mean number of events per unit area. As the value of intensity remains constant over the whole region, it is a homogeneous process.\nEvents are independent from each other and their locations are uniformly distributed over region A.\n\nWhile it may be impossible to achieve CSR in practice, tests of CSR may be helpful for formulating ecologically interesting hypotheses of patterns and distinguishing between ‘regular’ and ‘aggregated’ data."
  },
  {
    "objectID": "posts/Introduction/index.html#dirichlet-tessellation-and-delaunay-triangulation",
    "href": "posts/Introduction/index.html#dirichlet-tessellation-and-delaunay-triangulation",
    "title": "Introduction",
    "section": "Dirichlet tessellation and Delaunay Triangulation",
    "text": "Dirichlet tessellation and Delaunay Triangulation\nDirichlet tessellation: Given \\(n\\) distinct events in a planar region A, we assign a ‘territory’ for each event so that for all points in a territory, the corresponding event is the closest event. Events with neighbouring territories are called continguous.\nDelaunay triangulation: Join up pairs of distinct events to form a triangularisation over the area. By taking perpendicular bisectors of these lines we can perform the Dirichlet tessellation.\nFor some location-specific covariates measured at each event, such as temperature and elevation, we can estimate the values of these covariates at other locations by considering the vertices of the triangle that they lie in. Each vertex will contribute to the value of the covariate proportionally to its angle."
  },
  {
    "objectID": "posts/Introduction/index.html#monte-carlo-tests",
    "href": "posts/Introduction/index.html#monte-carlo-tests",
    "title": "Introduction",
    "section": "Monte Carlo Tests",
    "text": "Monte Carlo Tests\nMonte Carlo tests were introduced by Barnard (1963). They are used when the underlying distribution of random variables is unknown, to estimate the parameters based on simulations.\nWe can use them to test for CSR (Besag and Diggle 1977), with the null hypothesis stating that events are uniformly and independently distributed across region A. One popular test statistic, proposed by Clarke and Evans (1954), is the sum of distances between each of the n events to its nearest neighbour. We denote this as \\(u_1\\). Relatively large values of \\(u_1\\) may indicate spatial regularity.\nAn alternative test statistic used by Bartlett (1964) was the distribution function of distances between 2 randomly chosen points on the given square. The observed frequencies of inter-tree distances were then compared with the expected values under CSR, using \\(\\chi^2\\) goodness-of-fit tests. According to Bartlett, Besag and Diggle, there was insufficient evidence to reject the null hypothesis of CSR. However, there was a dependence between inter-tree measurements with a common end-point which may invalidate the obvious conclusion."
  },
  {
    "objectID": "posts/Models/index.html",
    "href": "posts/Models/index.html",
    "title": "Various Models for Point Patterns",
    "section": "",
    "text": "This topic will be about different models for point patterns, including:\n\nContagious distributions\nPoisson cluster processes\nInhomogeneous Poisson processes\nCox processes\n\n\nContagious distributions\nThe term was first used by Neyman (Neyman 1939) to describe discrete distributions that exhibits contagious or clustering behaviour. Neyman proposed a Poisson process of egg- masses. Larvae hatch from these eggs, and then move to positions relative to the eggs according to a bivariate distribution.\nSuppose the number of egg clusters is \\(M\\), which follows a Poisson process of intensity \\(\\rho\\), and each cluster produces a random number \\(S\\) of offspring (larvae). Therefore \\(M\\) follows a Poisson distribution with mean \\(\\rho |A|\\). The number of larvae in region \\(A\\) is \\(N(A) = S_1 + \\dots + S_M\\). If the probability generating function (pgf) of \\(S\\) is \\(\\pi_s(z)\\), the pgf for \\(N(A)\\) is: \\[\n\\pi(z; A) = exp[-\\rho |A| \\{1-\\pi_s(z)\\}]\n\\] Neyman’s Type A distribution is obtained by setting \\(\\pi_s(z) = exp[-\\mu(1-z)]\\).\nNow let the number of egg masses per unit area follow a Poisson process of mean \\(k\\rho\\), where \\(k\\) also follows a Poisson distribution with a known mean. In this case, we get a mixed, or compound Poisson distribution. The number of larvae per unit area still follows a Neyman’s Type A distribution.\nHowever according to Evans (Evans 1953), plant quadrat count data are very well fitted to Neyman’s Type A distribution, but not insect counts. Instead, insect count data are fitted by the negative binomial distribution. This is possibility due to greater competition and overcrowding in plants.\nThe negative binomial distribution is obtained when \\(S\\) has a logarithmic series distribution with \\(\\pi_s(z) = 1 - log\\{1+\\beta(1-z)\\}/log(1+\\beta)\\) for some \\(\\beta &gt; 0\\). It can be derived as a compounded, or mixed Poisson distribution, in which the parameter is determined by random sampling from a gamma distribution.\n\n\nPoisson cluster processes\nPoisson cluster processes follow 3 postulates:\n\nParent events follow a Poisson process with intensity \\(\\rho\\).\n\\(S_i\\), the number of offspring that the \\(i\\)th parent produces, are independent and identically distributed, with probability distribution \\(p_s: s = 0, 1, \\dots\\)\nThe positions of the offspring relative to the parents are also independent and identically distributed with a bivariate pdf \\(h\\).\n\nLet the pdf of the vector difference between positions of 2 offspring with the same parent be: \\[\nh_2(x) = \\int h(x)h(x-y)dx\n\\] And denote the corresponding cdf as \\(H_2(x)\\). For an arbitrary event in a cluster of size \\(S\\), the expected number of other events from the same cluster located within distance \\(t\\) is \\((S-1)H_2(t)\\). The probability distribution of the cluster size of the arbitrary event is obtained by length-biased sampling from the cluster size distribution, \\(p(s)\\): We get \\(p*(s) = sp(s)/\\mu\\), where \\(\\mu = E(S)\\). Taking the average, we get that the expected number of related events within distance \\(t\\) is \\(E[S(S-1)]H_2(t)/\\mu\\).\nFor unrelated events, since they are assumed to be located independently of the parent event, the expected number of unrelated events within distance \\(t\\) of the arbitrary event is \\(\\lambda \\pi t^2\\). Summing up the formulae for both related and unrelated events, we get: \\[\n\\lambda K(t) = \\lambda \\pi t^2 + E[S(S-1)]H_2(t)/\\mu\n\\] Dividing by \\(\\lambda = \\rho \\mu\\), we obtain the K-function: \\[\nK(t) = \\pi t^2 + E[S(S-1)]H_2(t)/(\\rho \\mu ^2)\n\\] As \\(t \\rightarrow \\infty\\), \\(K(t) - \\pi t^2\\) tends to a constant, \\(E[S(S-1)]/(\\rho \\mu^2)\\).\n\n\nInhomogeneous Poisson processes\nThe 2 main properties for an inhomogeneous Poisson process are:\n\n\\(N(A)\\) has a Poisson distribution with mean \\(\\int_A \\lambda(x) dx\\).\nGiven there are \\(n\\) events in region \\(A\\), they are an independent random sample of a distribution on \\(A\\) with a pdf proportional to the rate, \\(\\lambda(x)\\).\n\nBy having the intensity as a function of spatial location, covariates may be introduced. Diggle has given an example: suppose the locations of a species of tree depends on the elavation of the ground. Then a possible intensity function may be \\(\\lambda(x) =\\) \\(exp(\\alpha + \\beta z(x))\\), where \\(z(x)\\) denotes the elavation at location \\(x\\).\nIn ecology, species presence-only data may be modelled with inhomogeneous Poisson processes. To account for sampling bias and detection errors, the data should be treated as a thinned data. (Mugumaarhahama 2022) We assume that the expected occurrences of in the region \\(A\\) is a Poisson random variable with mean \\(\\mu(A) = \\int_A \\lambda(s) ds\\). (M. 2014) \\(\\lambda(s)\\) is formulated as a log-linear function with unknown parameters \\(\\beta\\) and location-specific covariates \\(x(s)\\) (such as elevation and temperature). We obtain a formula of the form: \\[\nlog(\\lambda(s)) = \\beta'x(s) = \\beta_0 + \\displaystyle \\sum_{j=1}^l \\beta_j x_j(s)\n\\] Assuming an individual is present at location \\(s\\). The probability of it being detected is \\(b(s)\\), where: \\[\nlogit(b(s)) = \\alpha' w(s) = \\alpha_0 + \\displaystyle \\sum_{j=1}^g \\alpha_j w_j(s)\n\\] where \\(w(s)\\) are location-specific covariates (such as distance to a road and populaধon centres).\nThe likelihood function for estimating \\(\\alpha\\) and \\(\\beta\\) is: \\[\nL(\\beta, \\alpha) = exp(-\\int_A \\lambda(s) b(s) ds) \\displaystyle \\prod_{i=1}^m \\lambda(s_i)b(s_i)\n\\]\n\n\nCox processes\nThe logic behind using the Poisson cluster process is that related events may cluster. Another reason for aggregation might be environmental heterogeneity, which we account for using the inhomogeneous Poisson process. However, this environmental heterogeneity itself might be stochastic. A Poisson process with stochastic intensity functions is called a Cox process.\nA spatial Cox process can be defined by the following postulates:\n\n\\(\\{\\Lambda(x): x \\in \\mathbb{R}^2 \\}\\) is a non-negative-valued stochastic process.\nConditional on \\(\\{\\Lambda(x) = \\lambda(x): x \\in \\mathbb{R}^2 \\}\\), the event form an inhomogeneous Poisson process with intensity function \\(\\lambda(x)\\).\n\nA Cox process is stationary if and only if the intensity process \\(\\Lambda(x)\\) is stationary. In this case, the intensity for the Cox process is obtained from taking expectation of the intensity process: \\(\\lambda = E[\\Lambda(x)]\\).\nGiven \\(\\{\\Lambda(x)\\}\\), the conditional intensity of a pair of events at locations \\(x\\) and \\(y\\) respectively, is \\(\\Lambda(x)\\Lambda(y)\\). Therefore \\(\\lambda_2(x,y) = E[\\Lambda(x)\\Lambda(y)]\\). In the stationary, isotropic case, this can be written as \\(\\lambda_2(t) = \\lambda^2 + \\gamma(t)\\), where \\(t = ||x-y||\\) and \\(\\gamma(t) = Cov\\{\\Lambda(x), \\Lambda(y)\\}\\).\nAccording to Kingman (Kingman 1977), we can use Cox processes to model for a reproducing population as well. Denote \\(G_n\\) as the point process that generates the locations, \\(X_i\\), of individuals in the \\(n\\)th generation. Suppose reproduction obeys the following rules:\n\nFor a parent at location \\(x_i\\), the number of offspring produced is a Poisson random variable with mean \\(\\mu_i = \\mu_i(G_n)\\)\nThe offspring’s locations relative to the parent follows a bivariate pdf and are independent from each other.\n\nThese rules are similar to the Poisson cluster process, but allow \\(\\mu_i\\) to depend on the configuration of the parents. \\(G_{n+1}\\) is thus the process defining the locations of the offspring. It is a Cox process defined by: \\[\n\\Lambda(x) = \\displaystyle \\sum_{i=1}^\\infty \\mu_i (G_n) h(x-x_i)\n\\] where \\(x_i\\) are events of the \\(n\\)th generation.\n\n\n\n\n\nReferences\n\nEvans, D. A. 1953. “Experimental Evidence Concerning Contagious Distributions in Ecology.” Biometrika 40: 186–211. https://doi.org/10.2307/2333108.\n\n\nJohnson, M. 2016. “Lecture Notes for ENTO 374 Economic Entomology University of Hawaii at Manoa, Spring 2001.”\n\n\nKingman, J. F. C. 1977. “Remarks on the Spatial Distribution of a Reproducing Population.” Journal of Applied Probability 14: 577–83. https://doi.org/10.2307/3213460.\n\n\nM., Dorazio R. 2014. “Accounting for Imperfect Detection and Survey Bias in Statistical Analysis of Presence-Only Data.” Global Ecology and Biogeography 23: 1472–84. https://doi.org/10.1111/geb.12216.\n\n\nMugumaarhahama, Fandohan, Y. 2022. “Inhomogeneous Poisson Point Process for Species Distribution Modelling: Relative Performance of Methods Accounting for Sampling Bias and Imperfect Detection.” Modeling Earth Systems and Environment 8: 5419–32. https://doi.org/10.1007/s40808-022-01417-3.\n\n\nNeyman, J. 1939. “On a New Class of \"Contagious\" Distributions, Applicable in Entomology and Bacteriology.” The Annals of Mathematical Statistics 10: 35–57."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html",
    "href": "posts/Simulations for CSR tests/index.html",
    "title": "Simulations for CSR Tests",
    "section": "",
    "text": "This post will be a collection of simulations I made based on the materials from the post ‘Testing for CSR’. The data I will be using are:\nThe first 3 have been used for demonstration in Diggle’s book, and my plots indeed show similar results to Diggle’s."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#japanese-black-pines",
    "href": "posts/Simulations for CSR tests/index.html#japanese-black-pines",
    "title": "Simulations for CSR Tests",
    "section": "Japanese black pines",
    "text": "Japanese black pines\nMy replication of Diggle’s plot on Japanese black pine saplings, using 99 simulations of CSR for the envelopes, affirms acceptance of CSR. This agrees with (Bartlett 1964) and (Besag and Diggle 1977), who used a \\(\\chi^2\\) test on a histogram of inter-event distances."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#redwood",
    "href": "posts/Simulations for CSR tests/index.html#redwood",
    "title": "Simulations for CSR Tests",
    "section": "Redwood",
    "text": "Redwood\n\\(\\hat{H}_1(t)\\) is greater than \\(H(t)\\) throughout the range, especially for very small and very large values of \\(H(t)\\), where \\(\\hat{H}_1(t)\\) exceeds the upper envelope. The excess number of small values of \\(H(t)\\) may be explained by Strauss’ remark that a distance of 6 feet on the ground (\\(t \\approx 0.08\\)), was “very roughly the range at which a pair of seedlings could interact.”\nA formal test of significance based on the measure of the discrepancy between \\(\\hat{H}_1(t)\\) and \\(H(t)\\), however, might suggest acceptance of CSR with a significance level of 0.22, according to Diggle. Indeed, \\(\\hat{H}_1(t)\\) lies relatively close to \\(H(t)\\) throughout the range. This shows that observation of the EDF plot with the simulation envelopes may provide insights that formal tests of significance do not."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#cells",
    "href": "posts/Simulations for CSR tests/index.html#cells",
    "title": "Simulations for CSR Tests",
    "section": "Cells",
    "text": "Cells\nAgain, a formal test of significance may suggest acceptance of CSR, with a significance level of 0.23. However with parts of the graph (especially at low values of \\(H(t)\\)) lying outside the simulation envelopes, it suggests otherwise. Note that for small values of \\(t\\), \\(\\hat{H}_1(t)=0\\), i.e. small inter-event distances are absent. This explains the regularity of the pattern. Also, for large values of \\(t\\), \\(\\hat{H}_1(t)\\) lies close to the upper envelope. Looking at the graph depicting the data, we can observe that there are no events present at the corners of the square. These empty spaces result in lack of large inter-event distances."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae",
    "href": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae",
    "title": "Simulations for CSR Tests",
    "section": "Beilschmiedia pendula (Lauraceae)",
    "text": "Beilschmiedia pendula (Lauraceae)\nClearly, with the excess of small inter-event distances and the deficit of larger inter-event distances, we have sufficient evidence to reject CSR. This is to be expected, as we see from the graph that events are clustered around certain areas, with large empty spaces near the middle part of the region and to the right."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#japanese-black-pines-1",
    "href": "posts/Simulations for CSR tests/index.html#japanese-black-pines-1",
    "title": "Simulations for CSR Tests",
    "section": "Japanese black pines",
    "text": "Japanese black pines\nThis plot suggests acceptance of CSR. According to Diggle, a formal Monte Carlo test based on the squared difference between \\(\\hat{G}\\) and \\(\\bar{G}\\) arrives at the same conclusion with significance level 0.52."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#redwood-1",
    "href": "posts/Simulations for CSR tests/index.html#redwood-1",
    "title": "Simulations for CSR Tests",
    "section": "Redwood",
    "text": "Redwood\nWith a large proportion of \\(\\hat{G}\\) lying above the upper envelope, there is strong evidence for rejecting CSR. This is supported by the Monte Carlo test, in which \\(u_1\\) is larger than all 99 simulated \\(u_j\\).\nThe excess of nearest neighbour distances is typical for an aggregated pattern like these redwood seedlings."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#cells-1",
    "href": "posts/Simulations for CSR tests/index.html#cells-1",
    "title": "Simulations for CSR Tests",
    "section": "Cells",
    "text": "Cells\nAgain, there is strong evidence against CSR. The Monte Carlo test also gives a \\(u_1\\) that is comfortably larger than all the other \\(u_j\\). Note that there is a lack of small nearest neighbour distances, characteristic of regular patterns."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae-1",
    "href": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae-1",
    "title": "Simulations for CSR Tests",
    "section": "Beilschmiedia pendula (Lauraceae)",
    "text": "Beilschmiedia pendula (Lauraceae)\nSimilar to the behaviour of the redwood saplings, there is a large proportion of \\(\\hat{G}\\) above the upper envelope, so we may reject CSR."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#japanese-black-pines-2",
    "href": "posts/Simulations for CSR tests/index.html#japanese-black-pines-2",
    "title": "Simulations for CSR Tests",
    "section": "Japanese black pines",
    "text": "Japanese black pines\nThis plot is obtained using a regular grid of 256 (\\(16 \\times 16\\)) points over the window. We see that \\(\\hat{F}\\) lies close to \\(F\\) throughout the range and between the envelopes. Just like our previous analysis of this data, we accept CSR."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#redwood-2",
    "href": "posts/Simulations for CSR tests/index.html#redwood-2",
    "title": "Simulations for CSR Tests",
    "section": "Redwood",
    "text": "Redwood\nAgain, we obtain the plot using the regular pattern of 256 points. Clearly \\(\\hat{F}\\) lies below the lower envelope for most of the range, suggesting rejection of CSR. This is a typical behaviour of aggregated pattern.\nPerforming a Monte Carlo test based on the squared differences between \\(\\hat{F}\\) and \\(\\bar{F}\\) gives the same conclusion, with \\(u_1\\) larger than all 99 simulated \\(u_j\\)."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#cells-2",
    "href": "posts/Simulations for CSR tests/index.html#cells-2",
    "title": "Simulations for CSR Tests",
    "section": "Cells",
    "text": "Cells\nThis time we use a regular grid of 196 (\\(14 \\times 14\\)) points. With a large proportion of the graph of \\(\\hat{F}\\) lying above the upper envelope, CSR is rejected. The Monte Carlo test agrees with this at the significant level of 0.02, according to Diggle."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae-2",
    "href": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae-2",
    "title": "Simulations for CSR Tests",
    "section": "Beilschmiedia pendula (Lauraceae)",
    "text": "Beilschmiedia pendula (Lauraceae)\nThe regular grid I used is of 7200 (\\(120 \\times 60\\)) points. Again, similar to the redwood saplings, \\(\\hat{F}\\) lies below the lower envelope for the most part. This suggests that CSR may be rejected, and this is an aggregated pattern."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#japanese-black-pines-3",
    "href": "posts/Simulations for CSR tests/index.html#japanese-black-pines-3",
    "title": "Simulations for CSR Tests",
    "section": "Japanese black pines",
    "text": "Japanese black pines\nFor the data set of Japanese black pine saplings, we may use a \\(3 \\times 3\\) grid to ensure that the expected frequencies are at least 5. Below is the observation:\n\nquadratcount(japanesepines, nx = 3, ny = 3)\n\n               x\ny               [0,0.333) [0.333,0.667) [0.667,1]\n  [0.667,1]             6            15         7\n  [0.333,0.667)        10             4         3\n  [0,0.333)             4             8         8\n\n\nTo perform the \\(\\chi^2\\) test, we may employ the quadrat.test function:\n\nquadrat.test(japanesepines, nx=3, ny=3, alternative='clustered')\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  japanesepines\nX2 = 15.169, df = 8, p-value = 0.05594\nalternative hypothesis: clustered\n\nQuadrats: 3 by 3 grid of tiles\n\n\nHere we observe that the one-sided p-value is about 0.06, so evidence against CSR is weak."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#redwood-3",
    "href": "posts/Simulations for CSR tests/index.html#redwood-3",
    "title": "Simulations for CSR Tests",
    "section": "Redwood",
    "text": "Redwood\nAgain we use a \\(3 \\times 3\\) grid for this dataset to keep the expected counts over 5.\n\nquadratcount(redwood3, nx = 3, ny = 3)\n\n                 x\ny                 [0,0.333) [0.333,0.667) [0.667,1]\n  [-0.333,0]              0             6        13\n  [-0.667,-0.333)        13             8         2\n  [-1,-0.667)             5             9         6\n\n\n\nquadrat.test(redwood3, nx=3, ny=3, alternative='clustered')\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  redwood3\nX2 = 22.774, df = 8, p-value = 0.003667\nalternative hypothesis: clustered\n\nQuadrats: 3 by 3 grid of tiles\n\n\nThe \\(X^2\\) value of 22.77 is highly significant (p-value of 0.0037), leading to rejection of CSR. If we try to use quadrats of different sizes:\n\nquadrat.test(redwood3, nx=4, ny=4, alternative='clustered')\n\nWarning: Some expected counts are small; chi^2 approximation may be inaccurate\n\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  redwood3\nX2 = 38.129, df = 15, p-value = 0.0008635\nalternative hypothesis: clustered\n\nQuadrats: 4 by 4 grid of tiles\n\nquadrat.test(redwood3, nx=2, ny=2, alternative='clustered')\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  redwood3\nX2 = 5.2258, df = 3, p-value = 0.156\nalternative hypothesis: clustered\n\nQuadrats: 2 by 2 grid of tiles\n\n\nWe see that the one-sided p-value for \\(4 \\times 4\\) is about 0.0002, also leading to rejection of CSR. However the p-value for \\(2 \\times 2\\) is 0.089. It is apparent that using different-sized quadrats may lead to different conclusions, and smaller-sized quadrats give stronger rejection of CSR."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#cells-3",
    "href": "posts/Simulations for CSR tests/index.html#cells-3",
    "title": "Simulations for CSR Tests",
    "section": "Cells",
    "text": "Cells\nWe will test on the data using the 3 different-sized quadrats mentioned for the redwood data. Here is the \\(3 \\times 3\\) quadrat counts for reference:\n\nquadratcount(cells, nx = 3, ny = 3)\n\n               x\ny               [0,0.333) [0.333,0.667) [0.667,1]\n  [0.667,1]             3             6         3\n  [0.333,0.667)         4             7         6\n  [0,0.333)             3             6         4\n\n\n\nquadrat.test(cells, nx=4, ny=4, alternative='regular')\n\nWarning: Some expected counts are small; chi^2 approximation may be inaccurate\n\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  cells\nX2 = 2.9524, df = 15, p-value = 0.0003641\nalternative hypothesis: regular\n\nQuadrats: 4 by 4 grid of tiles\n\nquadrat.test(cells, nx=3, ny=3, alternative='regular')\n\nWarning: Some expected counts are small; chi^2 approximation may be inaccurate\n\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  cells\nX2 = 4.2857, df = 8, p-value = 0.1695\nalternative hypothesis: regular\n\nQuadrats: 3 by 3 grid of tiles\n\nquadrat.test(cells, nx=2, ny=2, alternative='regular')\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  cells\nX2 = 0.47619, df = 3, p-value = 0.07591\nalternative hypothesis: regular\n\nQuadrats: 2 by 2 grid of tiles\n\n\nSince we have established that the cells data is a regular pattern, we may evaluate the p-value as \\(P(\\chi^2 &lt; X^2)\\) instead.\nThe p-values defined this way for \\(2 \\times 2, 3 \\times 3, 4 \\times 4\\) grids are 0.076, 0.17, 0.0004 respectively. This shows that the observed values of \\(X^2\\) are below expectation in all of them, and at a significance level of 0.1 we may reject CSR except for the \\(3 \\times 3\\) grid. The failure in rejection for this grid and the large significance level suggests that this test is weak against regular patterns."
  },
  {
    "objectID": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae-3",
    "href": "posts/Simulations for CSR tests/index.html#beilschmiedia-pendula-lauraceae-3",
    "title": "Simulations for CSR Tests",
    "section": "Beilschmiedia pendula (Lauraceae)",
    "text": "Beilschmiedia pendula (Lauraceae)\n\nquadrat.test(bei, nx=38, ny=19, alternative='clustered')\n\nWarning: Some expected counts are small; chi^2 approximation may be inaccurate\n\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  bei\nX2 = 8605.9, df = 721, p-value &lt; 2.2e-16\nalternative hypothesis: clustered\n\nQuadrats: 38 by 19 grid of tiles\n\nquadrat.test(bei, nx=37, ny=19, alternative='clustered')\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  bei\nX2 = 9397.2, df = 702, p-value &lt; 2.2e-16\nalternative hypothesis: clustered\n\nQuadrats: 37 by 19 grid of tiles\n\nquadrat.test(bei, nx=38, ny=18, alternative='clustered')\n\n\n    Chi-squared test of CSR using quadrat counts\n\ndata:  bei\nX2 = 8349.7, df = 683, p-value &lt; 2.2e-16\nalternative hypothesis: clustered\n\nQuadrats: 38 by 18 grid of tiles\n\n\nI have performed tests using \\(38 \\times 19\\), \\(37 \\times 19\\) and \\(38 \\times 18\\), which give expected counts of around 5. All of the p-values obtained are very small, so there is strong evidence for rejection of CSR.\nIt is evident that CSR would be rejected for Beilschmiedia Pendula, using all the methods mentioned above. Indeed, the sampling region has elevations and swamp areas, which make the distribution of these trees an inhomogeneous process."
  }
]